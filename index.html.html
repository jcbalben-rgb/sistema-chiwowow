<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Chi-Wow-Wow (Final Pro)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap');

        :root {
            --brand-dark: #1B2631; 
            --brand-gold: #D4AF37; 
            --text-main: #2C3E50;
            --text-light: #7F8C8D;
            --bg-light: #F4F6F6;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #525659;
            margin: 0;
            padding: 20px;
            color: var(--text-main);
        }

        .main-container { max-width: 950px; margin: 0 auto; }

        /* --- FORMULARIO --- */
        .control-panel {
            background: white; padding: 25px; border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); border-top: 6px solid var(--brand-dark);
            margin-bottom: 40px;
        }

        .panel-title {
            font-family: 'Montserrat', sans-serif; font-weight: 700; color: var(--brand-dark);
            margin: 0 0 20px 0; border-bottom: 2px solid #eee; padding-bottom: 10px; font-size: 1.3rem; text-align: center;
        }

        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 600; color: var(--text-light); margin-bottom: 5px; text-transform: uppercase; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #BDC3C7; border-radius: 6px; box-sizing: border-box; }
        
        .btn-action {
            background-color: var(--brand-dark); color: white; border: none; padding: 15px;
            font-family: 'Montserrat', sans-serif; font-weight: 700; text-transform: uppercase;
            cursor: pointer; width: 100%; border-radius: 6px; transition: background 0.3s;
        }
        .btn-action:hover { background-color: #2C3E50; }

        /* --- DOCUMENTOS (HOJAS) --- */
        .document-page {
            display: none; 
            background: white; 
            width: 21.59cm; 
            height: 27.94cm; /* Altura Fija Carta */
            margin: 0 auto 40px auto; 
            padding: 1.5cm 2cm; /* M√°rgenes seguros y elegantes */
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            box-sizing: border-box; 
            position: relative;
            overflow: hidden; 
        }

        /* --- HOJA 1: RECIBO --- */
        header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 3px solid var(--brand-dark); padding-bottom: 15px; margin-bottom: 25px; }
        .logo-img { max-width: 130px; margin-bottom: 10px; }
        .company-branding h1 { font-family: 'Montserrat', sans-serif; font-size: 18px; color: var(--brand-dark); margin: 0; text-transform: uppercase; font-weight: 700; }
        .fiscal-details { font-size: 0.7rem; color: var(--text-light); line-height: 1.4; margin-top: 5px; }
        .receipt-title { font-family: 'Montserrat', sans-serif; font-size: 28px; font-weight: 700; color: var(--brand-dark); opacity: 0.9; text-transform: uppercase; margin: 0; text-align: right; }

        .info-columns { display: flex; justify-content: space-between; gap: 20px; margin-bottom: 25px; background: var(--bg-light); padding: 15px; border-radius: 8px; }
        .info-box { flex: 1; }
        .box-title { font-family: 'Montserrat', sans-serif; font-size: 0.8rem; text-transform: uppercase; color: var(--brand-dark); font-weight: 700; border-bottom: 2px solid var(--brand-gold); margin-bottom: 8px; padding-bottom: 2px; }
        .info-box p { margin: 3px 0; font-size: 0.9rem; }

        .concept-table { width: 100%; border-collapse: separate; border-spacing: 0; margin-bottom: 25px; border: 1px solid #eee; border-radius: 8px; }
        .concept-table th { background: var(--brand-dark); color: white; padding: 10px; text-align: left; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; }
        .concept-table td { padding: 12px; border-bottom: 1px solid #eee; font-size: 0.9rem; }
        .total-row.final { font-size: 1.2rem; color: var(--brand-dark); font-weight: 700; border-top: 3px solid var(--brand-gold); padding-top: 10px; text-align: right; }

        /* --- HOJA 2: CONTRATO (OPTIMIZADO) --- */
        #contract-document.flex-mode {
            display: flex !important;
            flex-direction: column;
            justify-content: space-between; 
        }

        .contract-header-flex {
            display: flex; justify-content: space-between; align-items: flex-end;
            border-bottom: 2px solid var(--brand-gold); padding-bottom: 10px; margin-bottom: 15px;
        }
        .contract-logo { max-height: 50px; width: auto; margin-bottom: 5px; }
        .contract-company-name { font-family: 'Montserrat', sans-serif; font-weight: 700; color: var(--brand-dark); font-size: 12px; text-transform: uppercase; }
        
        .contract-main-title { margin: 0; color: var(--brand-dark); font-family: 'Montserrat', sans-serif; font-size: 16px; font-weight: 700; text-transform: uppercase; text-align: right; }
        .contract-folio-ref { font-family: 'Montserrat', sans-serif; font-size: 10px; color: var(--brand-gold); font-weight: 700; margin-top: 2px; text-align: right; }

        .contract-meta-box { display: flex; justify-content: space-between; font-size: 9pt; margin-bottom: 15px; background: var(--bg-light); padding: 8px 12px; border-radius: 4px; border-left: 4px solid var(--brand-dark); }
        .meta-label { font-weight: 700; color: var(--text-light); text-transform: uppercase; margin-right: 5px; }
        .meta-value { font-weight: 600; color: var(--brand-dark); text-transform: uppercase; }
        
        /* CUERPO DEL CONTRATO - LETRA OPTIMIZADA PARA QUE QUEPA TODO */
        .contract-body { 
            font-size: 9pt; /* 9 Puntos: Est√°ndar legal, limpio y ahorra espacio */
            text-align: justify; 
            line-height: 1.3; 
            color: #333; 
            flex-grow: 1; 
        }

        .contract-clause { margin-bottom: 8px; } 
        .clause-title { 
            color: var(--brand-dark); font-family: 'Montserrat', sans-serif; font-weight: 700; text-transform: uppercase; 
            display: block; margin-bottom: 2px; font-size: 9.5pt; 
            border-bottom: 1px solid #ccc; 
        }
        .sub-clause { margin-bottom: 2px; padding-left: 0; position: relative; }
        .sub-clause strong { color: var(--brand-dark); font-weight: 600; }

        /* Secci√≥n inferior */
        .bottom-section { 
            margin-top: 10px; 
            padding-top: 5px; 
        }

        /* Espacio para notas manuales (compacto pero √∫til) */
        .manual-space-indicator {
            height: 30px; 
            border-bottom: 1px dashed #ddd; 
            margin-bottom: 10px;
        }

        .legal-footer {
            margin-bottom: 10px;
            font-size: 7.5pt; 
            color: #555; 
            text-align: justify;
            border-top: 1px solid #eee; 
            padding-top: 5px;
        }

        .acceptance-text { text-align: center; margin: 10px 0; font-weight: 700; font-size: 8.5pt; color: var(--brand-dark); text-transform: uppercase; letter-spacing: 0.5px; }

        .signatures { display: flex; justify-content: space-between; gap: 40px; margin-top: 5px; margin-bottom: 20px; }
        .sign-box { flex: 1; border-top: 1px solid var(--brand-dark); text-align: center; padding-top: 5px; font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 8pt; color: var(--brand-dark); }
        .sign-client-name { display: block; margin-top: 2px; font-weight: 500; color: var(--text-main); font-size: 7.5pt; }

        .controls { text-align: center; margin-top: 30px; padding-bottom: 50px; display: flex; justify-content: center; gap: 20px; }
        .btn-secondary { background: #95a5a6; color: white; border: none; padding: 15px 25px; border-radius: 6px; cursor: pointer; font-family: 'Montserrat', sans-serif; font-weight: 600; text-transform: uppercase; }

        /* --- IMPRESI√ìN --- */
        @media print {
            @page { size: letter; margin: 0; }
            body { background: white; margin: 0; padding: 0; }
            .control-panel, .controls, button { display: none !important; }
            
            .document-page { 
                display: block; width: 21.59cm; height: 27.94cm; margin: 0; 
                padding: 1.5cm 2cm; /* M√°rgenes perfectos para impresi√≥n */
                box-shadow: none; page-break-after: always; overflow: hidden; 
            }
            
            #contract-document { display: flex !important; flex-direction: column; justify-content: space-between; }
            .document-page:last-child { page-break-after: avoid !important; }
            .manual-space-indicator::after { display: none; } 
        }
    </style>
</head>
<body>

    <div class="main-container">

        <div class="control-panel" id="input-form">
            <h2 class="panel-title">Sistema de Gesti√≥n Chi-Wow-Wow</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>Nombre del Cliente (Titular)</label>
                    <input type="text" id="in_nombre" placeholder="Nombre completo">
                </div>
                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="text" id="in_tel" placeholder="Contacto">
                </div>
                <div class="form-group">
                    <label>Correo Electr√≥nico</label>
                    <input type="email" id="in_email" placeholder="email@cliente.com">
                </div>
            </div>

            <div class="form-grid">
                <div class="form-group" style="grid-column: span 2;">
                    <label>Servicio Contratado</label>
                    <select id="in_servicio" onchange="toggleOtro(this)">
                        <option value="Expedici√≥n Creel y Chepe">Expedici√≥n Creel y Chepe</option>
                        <option value="Viaje a la Huasteca Potosina">Viaje a la Huasteca Potosina</option>
                        <option value="Tour Barrancas del Cobre">Tour Barrancas del Cobre</option>
                        <option value="Renta de Van Sprinter">Renta de Van Sprinter</option>
                        <option value="Traslado Privado">Traslado Privado</option>
                        <option value="OTRO">OTRO (Especificar...)</option>
                    </select>
                    <input type="text" id="in_servicio_otro" style="display:none; margin-top:10px; background:#F0F3F4;" placeholder="Escriba el nombre del servicio...">
                </div>
                <div class="form-group">
                    <label>Fechas</label>
                    <input type="text" id="in_fechas" placeholder="Ej. 12 al 15 Oct">
                </div>
                <div class="form-group">
                    <label>Pasajeros</label>
                    <input type="number" id="in_pax" value="1" min="1">
                </div>
            </div>

            <div class="form-group">
                <label>Notas Adicionales</label>
                <textarea id="in_notas" rows="3"></textarea>
            </div>

            <div class="form-grid" style="border-top: 2px solid #eee; padding-top:25px; margin-top: 25px;">
                <div class="form-group">
                    <label>Costo Total ($)</label>
                    <input type="number" id="in_total" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>Abono ($)</label>
                    <input type="number" id="in_abono" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>M√©todo de Pago</label>
                    <select id="in_metodo">
                        <option>Transferencia Electr√≥nica</option>
                        <option>Dep√≥sito Bancario</option>
                        <option>Tarjeta de Cr√©dito/D√©bito</option>
                        <option>Efectivo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha de Emisi√≥n</label>
                    <input type="date" id="in_fecha">
                </div>
            </div>

            <button class="btn-action" onclick="generarDocumento()">Generar Documentos Oficiales</button>
        </div>

        <div id="receipt-document" class="document-page">
            <header>
                <div class="company-branding">
                    <img src="chiwowow 2.png" alt="Logo Chi-Wow-Wow" class="logo-img">
                    <h1>CHIWOW-WOW A & T</h1>
                    <div class="fiscal-details">
                        <strong>RAZ√ìN SOCIAL:</strong> CHIWOW-WOW A & T, S.A. DE C.V.<br>
                        <strong>RFC:</strong> CAT2205094P0<br>
                        Av. Heroico Colegio Militar #7716, Chihuahua, Chih.<br>
                        R√©gimen: Sociedad An√≥nima de Capital Variable
                    </div>
                </div>
                <div class="receipt-meta">
                    <div class="receipt-title">RECIBO OFICIAL</div>
                    <div style="font-size: 1.3rem; color: var(--brand-gold); font-weight: 700; margin-top:10px; text-align: right;" id="out_folio">#00000</div>
                    <div style="font-size: 0.95rem; margin-top:10px; text-align: right; color: var(--text-light);">Fecha: <span id="out_fecha_emision"></span></div>
                </div>
            </header>

            <div class="info-columns">
                <div class="info-box">
                    <div class="box-title">Datos del Cliente</div>
                    <p><strong id="out_cliente" style="font-size: 1.1rem;"></strong></p>
                    <p>Tel: <span id="out_tel"></span></p>
                    <p>Email: <span id="out_email"></span></p>
                </div>
                <div class="info-box" style="border-left: 2px solid #eee; padding-left: 30px;">
                    <div class="box-title">Detalles del Servicio</div>
                    <p><strong id="out_servicio" style="font-size: 1.1rem;"></strong></p>
                    <p>Fechas: <span id="out_fechas"></span></p>
                    <p>Pax: <span id="out_pax"></span> Personas</p>
                </div>
            </div>

            <table class="concept-table">
                <thead>
                    <tr>
                        <th style="width: 55%;">Descripci√≥n</th>
                        <th style="width: 25%;">M√©todo</th>
                        <th style="text-align:right; width: 20%;">Importe</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            Costo Total del Servicio Tur√≠stico
                            <div style="margin-top: 5px;"><small id="out_notas" style="color:var(--text-light); font-style: italic;"></small></div>
                        </td>
                        <td style="text-align: center;">-</td>
                        <td style="text-align:right; font-weight: 600;" id="out_total"></td>
                    </tr>
                    <tr>
                        <td>Abono a Cuenta Recibido</td>
                        <td id="out_metodo" style="text-align: center;"></td>
                        <td style="text-align:right; color:#c0392b; font-weight: 600;" id="out_abono"></td>
                    </tr>
                </tbody>
            </table>

            <div class="totals-section">
                <div style="text-align:right; margin-left: auto; width: 300px;">
                    <div class="total-row final">Saldo Pendiente: <span id="out_saldo"></span></div>
                </div>
            </div>
            
            <div style="text-align:center; font-size:0.75rem; color:var(--text-light); position: absolute; bottom: 40px; width: 85%; left: 50%; transform: translateX(-50%);">
                Este documento es un comprobante interno. Tel: 614 286 0572.
            </div>
        </div>

        <div id="contract-document" class="document-page">
            
            <div>
                <div class="contract-header-flex">
                    <div class="contract-branding-col">
                        <img src="chiwowow 2.png" alt="Logo" class="contract-logo">
                        <div class="contract-company-name">CHIWOW-WOW A & T</div>
                    </div>
                    <div class="contract-title-col">
                        <h2 class="contract-main-title">CONTRATO DE SERVICIOS</h2>
                        <div class="contract-folio-ref">FOLIO: <span id="contrato_folio"></span></div>
                    </div>
                </div>
                
                <div class="contract-meta-box">
                    <div><span class="meta-label">TITULAR:</span> <span id="contrato_cliente" class="meta-value"></span></div>
                    <div><span class="meta-label">FECHA:</span> <span id="contrato_fecha" class="meta-value"></span></div>
                </div>

                <div class="contract-body">
                    <p style="margin-bottom: 10px;">Contrato de prestaci√≥n de servicios tur√≠sticos celebrado entre <strong>CHIWOW-WOW A & T, S.A. DE C.V.</strong> ("LA EMPRESA") y "EL CLIENTE", <strong>quien suscribe por s√≠ mismo y en representaci√≥n de sus acompa√±antes</strong>. Al realizar cualquier pago, las partes aceptan las siguientes cl√°usulas:</p>

                    <div class="contract-clause">
                        <span class="clause-title">1. COMPROMISO Y GARANT√çA</span>
                        <div class="sub-clause"><strong>Calidad:</strong> Unidades garantizadas en √≥ptimas condiciones mec√°nicas, de limpieza e higiene, con A/C funcional.</div>
                        <div class="sub-clause"><strong>Seguridad Legal:</strong> Servicio por operadores con <strong>Licencia Federal vigente</strong>. Unidades con permisos federales, placas y <strong>P√≥liza de Seguro de Viajero</strong>.</div>
                        <div class="sub-clause"><strong>Cumplimiento:</strong> Se respetar√°n itinerarios y horarios pactados, garantizando el servicio contratado (salvo fuerza mayor).</div>
                    </div>

                    <div class="contract-clause">
                        <span class="clause-title">2. PAGOS Y LIQUIDACI√ìN</span>
                        <div class="sub-clause"><strong>Anticipo:</strong> Todo anticipo, reserva o apartado es <strong>NO REEMBOLSABLE</strong>. Garantiza la disponibilidad y gastos administrativos.</div>
                        <div class="sub-clause"><strong>Liquidaci√≥n:</strong> El servicio debe liquidarse al 100% al menos <strong>3 d√≠as (72 horas) antes</strong> del viaje. De no ser as√≠, se cancelar√° sin devoluci√≥n.</div>
                    </div>

                    <div class="contract-clause">
                        <span class="clause-title">3. POL√çTICAS DE CANCELACI√ìN</span>
                        <div class="sub-clause"><strong>Por el Cliente:</strong> Si cancela o no se presenta (<strong>"No Show"</strong>), <strong>NO HABR√Å DEVOLUCIONES</strong>. El pago es pena convencional.</div>
                        <div class="sub-clause"><strong>Fuerza Mayor:</strong> Si el viaje no se realiza por causas ajenas a LA EMPRESA (clima, bloqueos, fallas), la √∫nica opci√≥n es <strong>CAMBIO DE FECHA</strong>. No hay reembolsos.</div>
                    </div>

                    <div class="contract-clause">
                        <span class="clause-title">4. REGLAMENTO, CONDUCTA Y RESPONSABILIDAD</span>
                        <div class="sub-clause"><strong>Prohibiciones:</strong> Estrictamente <strong>PROHIBIDO</strong> consumir alcohol, estupefacientes o fumar (incluyendo "vapes") dentro de la unidad.</div>
                        <div class="sub-clause"><strong>Responsabilidad:</strong> EL CLIENTE cubre de inmediato cualquier da√±o o suciedad excesiva causada por √©l o sus acompa√±antes.</div>
                        <div class="sub-clause"><strong>Autoridad:</strong> El operador puede bajar a cualquier persona con conducta agresiva o peligrosa, sin derecho a reembolso.</div>
                    </div>

                    <div class="contract-clause">
                        <span class="clause-title">5. LOG√çSTICA Y SEGURIDAD</span>
                        <div class="sub-clause"><strong>Tolerancia:</strong> M√°ximo <strong>10 minutos</strong> de tolerancia a la salida. Transcurrido este tiempo, la unidad partir√° sin responsabilidad.</div>
                        <div class="sub-clause"><strong>Seguro:</strong> Cubre exclusivamente mientras EL CLIENTE est√© a bordo. No cubre accidentes externos ni objetos olvidados.</div>
                    </div>
                </div>
            </div>

            <div class="bottom-section">
                <div class="manual-space-indicator"></div>

                <div class="legal-footer">
                    <strong>JURISDICCI√ìN:</strong> Para la interpretaci√≥n y cumplimiento de este contrato, las partes se someten a la jurisdicci√≥n de los tribunales de <strong>Chihuahua, Chih.</strong>, renunciando a cualquier otro fuero por raz√≥n de sus domicilios.
                </div>

                <div class="acceptance-text">
                    LE√çDO LO ANTERIOR, ACEPTO INCONDICIONALMENTE LOS T√âRMINOS.
                </div>

                <div class="signatures">
                    <div class="sign-box">
                        <br><br><br> FIRMA REPRESENTANTE<br>CHIWOW-WOW A & T
                    </div>
                    <div class="sign-box">
                        <br><br><br> FIRMA CLIENTE TITULAR<br><span id="firma_nombre_cliente" class="sign-client-name"></span>
                    </div>
                </div>
            </div>

        </div>

        <div class="controls" id="btn-container">
            <button class="btn-action" style="width: auto; padding: 15px 30px;" onclick="window.print()">üñ®Ô∏è IMPRIMIR / PDF</button>
            <button class="btn-secondary" onclick="editar()">‚úèÔ∏è EDITAR</button>
        </div>

    </div>

    <script>
        document.getElementById('in_fecha').valueAsDate = new Date();

        function toggleOtro(select) {
            const otroInput = document.getElementById('in_servicio_otro');
            if (select.value === 'OTRO') {
                otroInput.style.display = 'block';
                otroInput.focus();
            } else {
                otroInput.style.display = 'none';
                otroInput.value = ''; 
            }
        }

        function generarDocumento() {
            const nombre = document.getElementById('in_nombre').value.trim() || ".............................";
            const tel = document.getElementById('in_tel').value.trim() || "N/A";
            const email = document.getElementById('in_email').value.trim() || "N/A";
            const fechaRaw = document.getElementById('in_fecha').value.split('-');
            const fechaFmt = `${fechaRaw[2]}/${fechaRaw[1]}/${fechaRaw[0]}`;
            const folioGenerado = "CWW-" + Math.floor(10000 + Math.random() * 90000);

            let servicio = document.getElementById('in_servicio').value;
            if (servicio === 'OTRO') servicio = document.getElementById('in_servicio_otro').value.trim() || "Servicio Personalizado";
            
            const fechasViaje = document.getElementById('in_fechas').value.trim() || "Por definir";
            const pax = document.getElementById('in_pax').value;
            const notas = document.getElementById('in_notas').value.trim();

            const total = parseFloat(document.getElementById('in_total').value) || 0;
            const abono = parseFloat(document.getElementById('in_abono').value) || 0;
            const saldo = total - abono;
            const metodo = document.getElementById('in_metodo').value;
            
            const fmt = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' });

            document.getElementById('out_folio').innerText = folioGenerado;
            document.getElementById('out_fecha_emision').innerText = fechaFmt;
            document.getElementById('out_cliente').innerText = nombre;
            document.getElementById('out_tel').innerText = tel;
            document.getElementById('out_email').innerText = email;
            document.getElementById('out_servicio').innerText = servicio;
            document.getElementById('out_fechas').innerText = fechasViaje;
            document.getElementById('out_pax').innerText = pax;
            document.getElementById('out_notas').innerText = notas ? `Nota: ${notas}` : '';

            document.getElementById('out_total').innerText = fmt.format(total);
            document.getElementById('out_abono').innerText = "- " + fmt.format(abono);
            document.getElementById('out_metodo').innerText = metodo;
            
            const saldoDiv = document.getElementById('out_saldo');
            if (saldo <= 0.01) {
                saldoDiv.innerHTML = `<span style="color:#27ae60;">${fmt.format(0)} (LIQUIDADO)</span>`;
            } else {
                saldoDiv.innerHTML = `<span style="color:#c0392b;">${fmt.format(saldo)}</span>`;
            }

            document.getElementById('contrato_folio').innerText = folioGenerado;
            document.getElementById('contrato_fecha').innerText = fechaFmt;
            document.getElementById('contrato_cliente').innerText = nombre;
            document.getElementById('firma_nombre_cliente').innerText = nombre;

            document.getElementById('input-form').style.display = 'none';
            const receiptDoc = document.getElementById('receipt-document');
            receiptDoc.style.display = 'block';
            const contractDoc = document.getElementById('contract-document');
            contractDoc.style.display = 'block';
            contractDoc.classList.add('flex-mode');
            
            document.getElementById('btn-container').style.display = 'flex';
            window.scrollTo(0, 0);
        }

        function editar() {
            document.getElementById('input-form').style.display = 'block';
            document.getElementById('receipt-document').style.display = 'none';
            const contractDoc = document.getElementById('contract-document');
            contractDoc.style.display = 'none';
            contractDoc.classList.remove('flex-mode');
            document.getElementById('btn-container').style.display = 'none';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>